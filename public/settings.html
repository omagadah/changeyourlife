<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard & Paramètres - Change Your Life</title>
    <link rel="stylesheet" href="./css/main.min.css">
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif; background: linear-gradient(135deg, #0a0e27 0%, #111827 100%); color: #f9fafb; min-height: 100vh; }
        #vanta-birds-bg { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 0; }
        .dashboard-container { position: relative; z-index: 1; display: flex; height: 100vh; }
        .sidebar { width: 280px; background: rgba(31, 41, 55, 0.8); backdrop-filter: blur(10px); border-right: 1px solid rgba(255, 255, 255, 0.1); display: flex; flex-direction: column; padding: 24px 16px; }
        .logo-section { display: flex; align-items: center; gap: 12px; padding: 12px; margin-bottom: 32px; }
        .logo-section svg { width: 40px; height: 40px; }
        .logo-section h1 { font-size: 1.25rem; font-weight: 700; background: linear-gradient(135deg, #3b82f6, #8b5cf6); -webkit-background-clip: text; -webkit-text-fill-color: transparent; }
        .nav-menu { flex: 1; overflow-y: auto; }
        .nav-section { margin-bottom: 24px; }
        .nav-section-title { font-size: 0.75rem; font-weight: 600; text-transform: uppercase; color: #9ca3af; padding: 8px 12px; margin-bottom: 8px; }
        .nav-item { display: flex; align-items: center; gap: 12px; padding: 12px; border-radius: 8px; color: #9ca3af; cursor: pointer; transition: all 0.2s; margin-bottom: 4px; }
        .nav-item:hover { background: rgba(59, 130, 246, 0.1); color: #3b82f6; }
        .nav-item.active { background: #3b82f6; color: white; }
        .nav-item svg { width: 20px; height: 20px; }
        .main-content { flex: 1; overflow-y: auto; padding: 32px; }
        .content-header { margin-bottom: 32px; }
        .content-header h2 { font-size: 2rem; font-weight: 700; margin-bottom: 8px; }
        .content-header p { color: #9ca3af; font-size: 1rem; }
        .stats-grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(250px, 1fr)); gap: 24px; margin-bottom: 32px; }
        .stat-card { background: rgba(31, 41, 55, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 24px; transition: transform 0.2s, box-shadow 0.2s; }
        .stat-card:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.3); }
        .stat-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 16px; }
        .stat-icon { width: 48px; height: 48px; border-radius: 12px; display: flex; align-items: center; justify-content: center; font-size: 24px; }
        .stat-icon.blue { background: rgba(59, 130, 246, 0.2); }
        .stat-icon.purple { background: rgba(139, 92, 246, 0.2); }
        .stat-icon.green { background: rgba(16, 185, 129, 0.2); }
        .stat-icon.orange { background: rgba(245, 158, 11, 0.2); }
        .stat-trend { font-size: 0.875rem; padding: 4px 12px; border-radius: 20px; font-weight: 600; }
        .stat-trend.up { background: rgba(16, 185, 129, 0.2); color: #10b981; }
        .stat-trend.down { background: rgba(239, 68, 68, 0.2); color: #ef4444; }
        .stat-value { font-size: 2.5rem; font-weight: 700; margin-bottom: 4px; }
        .stat-label { color: #9ca3af; font-size: 0.875rem; }
    .chart-card { background: rgba(31, 41, 55, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 24px; margin-bottom: 32px; max-width: 700px; height: 350px; }
        .chart-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 24px; }
        .chart-title { font-size: 1.25rem; font-weight: 600; }
        .chart-filters { display: flex; gap: 8px; }
        .filter-btn { padding: 8px 16px; border-radius: 8px; border: 1px solid rgba(255, 255, 255, 0.1); background: transparent; color: #9ca3af; cursor: pointer; transition: all 0.2s; }
        .filter-btn:hover { background: rgba(59, 130, 246, 0.1); color: #3b82f6; }
        .filter-btn.active { background: #3b82f6; color: white; border-color: #3b82f6; }
        .settings-section { display: none; }
        .settings-section.active { display: block; }
        .settings-group { background: rgba(31, 41, 55, 0.6); backdrop-filter: blur(10px); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 16px; padding: 24px; margin-bottom: 24px; }
        .settings-group-title { font-size: 1.125rem; font-weight: 600; margin-bottom: 16px; }
        .setting-item { display: flex; align-items: center; justify-content: space-between; padding: 16px 0; border-bottom: 1px solid rgba(255, 255, 255, 0.1); }
        .setting-item:last-child { border-bottom: none; }
        .setting-info h4 { font-size: 1rem; margin-bottom: 4px; }
        .setting-info p { font-size: 0.875rem; color: #9ca3af; }
        .toggle-switch { position: relative; width: 52px; height: 28px; }
        .toggle-switch input { opacity: 0; width: 0; height: 0; }
        .toggle-slider { position: absolute; cursor: pointer; inset: 0; background: #374151; border-radius: 28px; transition: 0.3s; }
        .toggle-slider:before { position: absolute; content: ""; height: 20px; width: 20px; left: 4px; bottom: 4px; background: white; border-radius: 50%; transition: 0.3s; }
        input:checked + .toggle-slider { background: #3b82f6; }
        input:checked + .toggle-slider:before { transform: translateX(24px); }
        .btn { padding: 12px 24px; border-radius: 8px; border: none; font-weight: 600; cursor: pointer; transition: all 0.2s; }
        .btn-primary { background: #3b82f6; color: white; }
        .btn-primary:hover { background: #2563eb; transform: translateY(-2px); }
        .btn-danger { background: #ef4444; color: white; }
        .btn-danger:hover { background: #dc2626; }
        .btn-secondary { background: rgba(255, 255, 255, 0.1); color: #f9fafb; }
        .input-group { margin-bottom: 20px; }
        .input-label { display: block; margin-bottom: 8px; color: #9ca3af; font-size: 0.875rem; }
        .input-field { width: 100%; padding: 12px; background: rgba(0, 0, 0, 0.3); border: 1px solid rgba(255, 255, 255, 0.1); border-radius: 8px; color: #f9fafb; font-size: 1rem; }
        .input-field:focus { outline: none; border-color: #3b82f6; box-shadow: 0 0 0 3px rgba(59, 130, 246, 0.1); }
        .danger-zone { background: rgba(239, 68, 68, 0.1); border: 1px solid #ef4444; border-radius: 16px; padding: 24px; }
        .danger-zone h3 { color: #ef4444; margin-bottom: 12px; }
        .header-logo { position: fixed; top: 20px; right: 30px; z-index: 200; background: none; border: none; cursor: pointer; padding: 0; }
    </style>
</head>
<body>
<div id="vanta-birds-bg"></div>
<button class="header-logo user-panel-trigger" title="Mon Compte" aria-label="Ouvrir le menu">
<svg data-cyf-logo="1" viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg" width="40" height="40">
<g stroke-width="3"><circle cx="60" cy="60" r="40" fill="black" stroke="#3399ff" stroke-width="8"/><line x1="100" y1="60" x2="130" y2="30" stroke="white"/><line x1="100" y1="60" x2="130" y2="60" stroke="white"/><line x1="100" y1="60" x2="130" y2="90" stroke="white"/><circle cx="150" cy="30" r="18" fill="none" stroke="white"/><circle cx="150" cy="60" r="18" fill="none" stroke="white"/><circle cx="150" cy="90" r="18" fill="none" stroke="white"/></g>
</svg>
</button>
<div class="dashboard-container">
<aside class="sidebar">
<div class="logo-section">
<svg viewBox="0 0 200 120" xmlns="http://www.w3.org/2000/svg"><circle cx="60" cy="60" r="40" fill="black" stroke="#3399ff" stroke-width="8"/></svg>
<h1>M.O.N.K.Y</h1>
</div>
<nav class="nav-menu">
<div class="nav-section">
<div class="nav-section-title">Dashboard</div>
<div class="nav-item active" data-section="dashboard">
<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0a1 1 0 001-1v-4a1 1 0 011-1h2a1 1 0 011 1v4a1 1 0 001 1m-6 0h6"/></svg>
<span>Vue d'ensemble</span>
</div>
</div>
<div class="nav-section">
<div class="nav-section-title">Paramètres</div>
<div class="nav-item" data-section="profile">
<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M16 7a4 4 0 11-8 0 4 4 0 018 0zM12 14a7 7 0 00-7 7h14a7 7 0 00-7-7z"/></svg>
<span>Profil</span>
</div>
<div class="nav-item" data-section="preferences">
<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z"/><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 12a3 3 0 11-6 0 3 3 0 016 0z"/></svg>
<span>Préférences</span>
</div>
<div class="nav-item" data-section="security">
<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"/></svg>
<span>Sécurité</span>
</div>
</div>
<div class="nav-section" id="admin-nav-section" style="display: none;">
<div class="nav-section-title">Administration</div>
<div class="nav-item" data-section="admin">
<svg fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12h6m-6 4h6m2 5H7a2 2 0 01-2-2V5a2 2 0 012-2h5.586a1 1 0 01.707.293l5.414 5.414a1 1 0 01.293.707V19a2 2 0 01-2 2z"/></svg>
<span>Panel Admin</span>
</div>
</div>
</nav>
</aside>
<main class="main-content">
<section id="dashboard" class="settings-section active">
<div class="content-header">
<h2>Dashboard M.O.N.K.Y</h2>
<p>Vue densemble de votre progression et bien-être</p>
</div>
<div class="stats-grid">
<div class="stat-card"><div class="stat-header"><div class="stat-icon blue"></div><div class="stat-trend up"> +12%</div></div><div class="stat-value">8.4</div><div class="stat-label">Humeur moyenne</div></div>
<div class="stat-card"><div class="stat-header"><div class="stat-icon purple"></div><div class="stat-trend up"> +5</div></div><div class="stat-value">24</div><div class="stat-label">Habitudes tenues</div></div>
<div class="stat-card"><div class="stat-header"><div class="stat-icon green"></div><div class="stat-trend down"> -8%</div></div><div class="stat-value">145</div><div class="stat-label">Minutes de focus</div></div>
<div class="stat-card"><div class="stat-header"><div class="stat-icon orange"></div><div class="stat-trend up"> +3</div></div><div class="stat-value">18</div><div class="stat-label">Entrées journal</div></div>
</div>
<div class="chart-card">
<div class="chart-header">
<h3 class="chart-title">Évolution M.O.N.K.Y (7 derniers jours)</h3>
<div class="chart-filters">
<button class="filter-btn active">7J</button>
<button class="filter-btn">30J</button>
<button class="filter-btn">3M</button>
</div>
</div>
<canvas id="monkyChart" width="650" height="300" style="display:block;max-width:100%;height:300px;"></canvas>
function s(){
    const e=document.getElementById("monkyChart");
    if(!e||!window.Chart)return;
    new Chart(e.getContext("2d"),{
        type:"line",
        data:{
            labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],
            datasets:[{
                label:"Score M.O.N.K.Y",
                data:[7.2,7.8,7.5,8.2,8.5,8.1,8.4],
                borderColor:"#3b82f6",
                backgroundColor:"rgba(59, 130, 246, 0.1)",
                borderWidth:3,
                tension:.4,
                fill:false,
                pointRadius:5,
                pointHoverRadius:7,
                pointBackgroundColor:"#3b82f6",
                pointBorderColor:"#fff",
                pointBorderWidth:2
            }]
        },
        options:{
            responsive:true,
            maintainAspectRatio:true,
            plugins:{
                legend:{display:false},
                tooltip:{backgroundColor:"rgba(31, 41, 55, 0.9)",padding:12,borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1}
            },
            scales:{
                y:{beginAtZero:false,min:6,max:10,ticks:{color:"#9ca3af"},grid:{color:"rgba(255, 255, 255, 0.05)"}},
                x:{ticks:{color:"#9ca3af"},grid:{color:"rgba(255, 255, 255, 0.05)"}}
            }
        }
    });
}
</div>
</section>
<section id="profile" class="settings-section">
<div class="content-header"><h2>Mon Profil</h2><p>Gérez vos informations personnelles</p></div>
<div class="settings-group">
<h3 class="settings-group-title">Informations générales</h3>
<div class="input-group"><label class="input-label">Nom d'utilisateur</label><input type="text" class="input-field" placeholder="Votre nom" id="profile-name"></div>
<div class="input-group"><label class="input-label">Email</label><input type="email" class="input-field" placeholder="votre@email.com" id="profile-email" readonly></div>
<button class="btn btn-primary">Enregistrer les modifications</button>
</div>
</section>
<section id="preferences" class="settings-section">
<div class="content-header"><h2>Préférences</h2><p>Personnalisez votre expérience</p></div>
<div class="settings-group">
<h3 class="settings-group-title">Apparence</h3>
<div class="setting-item"><div class="setting-info"><h4>Thème sombre</h4><p>Activer le mode sombre pour réduire la fatigue oculaire</p></div><label class="toggle-switch"><input type="checkbox" id="dark-theme" checked><span class="toggle-slider"></span></label></div>
<div class="setting-item"><div class="setting-info"><h4>Animations</h4><p>Activer les animations de l'interface</p></div><label class="toggle-switch"><input type="checkbox" id="animations" checked><span class="toggle-slider"></span></label></div>
</div>
<div class="settings-group">
<h3 class="settings-group-title">Notifications</h3>
<div class="setting-item"><div class="setting-info"><h4>Rappels quotidiens</h4><p>Recevoir des rappels pour vos habitudes</p></div><label class="toggle-switch"><input type="checkbox" id="daily-reminders"><span class="toggle-slider"></span></label></div>
<div class="setting-item"><div class="setting-info"><h4>Notifications par email</h4><p>Recevoir des résumés hebdomadaires par email</p></div><label class="toggle-switch"><input type="checkbox" id="email-notifications"><span class="toggle-slider"></span></label></div>
</div>
</section>
<section id="security" class="settings-section">
<div class="content-header"><h2>Sécurité</h2><p>Protégez votre compte</p></div>
<div class="settings-group">
<h3 class="settings-group-title">Mot de passe</h3>
<p style="color: #9ca3af; margin-bottom: 16px;">Changez régulièrement votre mot de passe pour plus de sécurité</p>
<button class="btn btn-secondary" id="change-password-btn">Changer le mot de passe</button>
</div>
<div class="danger-zone">
<h3>Zone de danger</h3>
<p style="margin-bottom: 16px; color: #9ca3af;">La suppression de votre compte est définitive et irréversible. Toutes vos données seront perdues.</p>
<button class="btn btn-danger" id="delete-account-btn">Supprimer mon compte</button>
</div>
</section>
<section id="admin" class="settings-section">
<div class="content-header"><h2>Panel Administrateur</h2><p>Outils réservés aux administrateurs</p></div>
<div class="settings-group">
<h3 class="settings-group-title">Outils Admin</h3>
<div class="input-group"><label class="input-label">UID Utilisateur</label><input type="text" class="input-field" placeholder="Entrez l'UID d'un utilisateur..." id="admin-uid"></div>
<button class="btn btn-primary" id="download-user-data-btn">Télécharger les données</button>
</div>
</section>
</main>
</div>
<script src="https://cdnjs.cloudflare.com/ajax/libs/three.js/r134/three.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.3/dist/chart.umd.min.js"></script>
<!-- VANTA.js birds background temporarily disabled for debug -->
<!-- <script src="https://cdn.jsdelivr.net/npm/vanta@latest/dist/vanta.birds.min.js"></script> -->
<!-- <script>VANTA.BIRDS({el:'#vanta-birds-bg',backgroundColor:0x0a0e27,color1:0x3b82f6,color2:0x8b5cf6,quantity:3.00,birdSize:1.2,wingSpan:25.00,speedLimit:4.00});</script> -->
<script type="module">
import{getAuth,onAuthStateChanged}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-auth.js";import{getFirestore}from"https://www.gstatic.com/firebasejs/10.12.2/firebase-firestore.js";import{setupThemeToggle,updateGlobalAvatar}from"./js/common.js";import{initUserMenu}from"./js/userMenu.js";const e={apiKey:"AIzaSyCvEtaivyC5QD0dGyPKh97IgYU8U8QrrWg",authDomain:"changeyourlife-cc210.firebaseapp.com",projectId:"changeyourlife-cc210",storageBucket:"changeyourlife-cc210.appspot.com",messagingSenderId:"801720080785",appId:"1:801720080785:web:1a74aadba5755ea26c2230"};let t,a;function n(){onAuthStateChanged(t,t=>{if(t){initUserMenu(),setupThemeToggle(),updateGlobalAvatar((t.email||"U").charAt(0).toUpperCase()),["PvDinfGc2hRribdPE4JW9Bv5Ip42"].includes(t.uid)&&(document.getElementById("admin-nav-section").style.display="block");const e=document.getElementById("profile-email");e&&(e.value=t.email),s(),o()}else{if(!["127.0.0.1","localhost"].includes(location.hostname))return void(window.location.href="inscription.html");s(),o()}})}function o(){document.querySelectorAll(".nav-item").forEach(e=>{e.addEventListener("click",()=>{const t=e.getAttribute("data-section");document.querySelectorAll(".nav-item").forEach(e=>e.classList.remove("active")),e.classList.add("active"),document.querySelectorAll(".settings-section").forEach(e=>e.classList.remove("active")),document.getElementById(t)?.classList.add("active")})})}function s(){const e=document.getElementById("monkyChart");if(!e||!window.Chart)return;new Chart(e.getContext("2d"),{type:"line",data:{labels:["Lun","Mar","Mer","Jeu","Ven","Sam","Dim"],datasets:[{label:"Score M.O.N.K.Y",data:[7.2,7.8,7.5,8.2,8.5,8.1,8.4],borderColor:"#3b82f6",backgroundColor:"rgba(59, 130, 246, 0.1)",borderWidth:3,tension:.4,fill:!0,pointRadius:5,pointHoverRadius:7,pointBackgroundColor:"#3b82f6",pointBorderColor:"#fff",pointBorderWidth:2}]},options:{responsive:!0,maintainAspectRatio:!1,plugins:{legend:{display:!1},tooltip:{backgroundColor:"rgba(31, 41, 55, 0.9)",padding:12,borderColor:"rgba(255, 255, 255, 0.1)",borderWidth:1}},scales:{y:{beginAtZero:!1,min:6,max:10,ticks:{color:"#9ca3af"},grid:{color:"rgba(255, 255, 255, 0.05)"}},x:{ticks:{color:"#9ca3af"},grid:{color:"rgba(255, 255, 255, 0.05)"}}}}})}window._cyfFirebase?({auth:t,db:a}=window._cyfFirebase,n()):import("https://www.gstatic.com/firebasejs/10.12.2/firebase-app.js").then(({initializeApp:o})=>{const s=o(e);t=getAuth(s),a=getFirestore(s),window._cyfFirebase={app:s,auth:t,db:a},n()}),window.addEventListener("DOMContentLoaded",()=>{updateGlobalAvatar(),document.querySelectorAll(".user-panel-trigger").forEach(e=>{e.addEventListener("click",e=>{e.stopPropagation(),initUserMenu();const t=document.getElementById("cyf-user-menu");t&&(t.style.display="block"===t.style.display?"none":"block")})})});
</script>
</body>
</html>
